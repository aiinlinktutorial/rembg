# APIæœåŠ¡ç¦»çº¿é—®é¢˜æ’é™¤æŒ‡å—

## é—®é¢˜åˆ†æ

æ ¹æ®æµ‹è¯•ç»“æœï¼Œæ‚¨çš„APIåœ¨https://rembg-12mt.onrender.com ä¸Šè¿”å›404é”™è¯¯ï¼Œä½†æœ¬åœ°æµ‹è¯•æ˜¾ç¤ºAPIä»£ç æœ¬èº«å·¥ä½œæ­£å¸¸ã€‚

## å¯èƒ½çš„åŸå› 

1. **ç«¯å£é…ç½®é—®é¢˜** - Renderå¯èƒ½æ²¡æœ‰æ­£ç¡®ç»‘å®šç«¯å£
2. **å¯åŠ¨å‘½ä»¤é—®é¢˜** - Dockerå®¹å™¨å¯èƒ½æ²¡æœ‰æ­£ç¡®å¯åŠ¨
3. **å¥åº·æ£€æŸ¥å¤±è´¥** - å¥åº·æ£€æŸ¥ç«¯ç‚¹å¯èƒ½æ— æ³•è®¿é—®

## è§£å†³æ–¹æ¡ˆ

### 1. ç«‹å³ä¿®å¤ (æ¨è)

æˆ‘å·²ç»æ›´æ–°äº†ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

- âœ… **Dockerfile** - æ·»åŠ äº† `--workers 1` å‚æ•°
- âœ… **render.yaml** - æ·»åŠ äº†æ˜ç¡®çš„ `dockerCommand`

### 2. éƒ¨ç½²ä¿®å¤

ç°åœ¨æ‚¨éœ€è¦å°†æ›´æ”¹æ¨é€åˆ°GitHubå¹¶é‡æ–°éƒ¨ç½²ï¼š

```bash
git add .
git commit -m "ä¿®å¤APIéƒ¨ç½²é…ç½®é—®é¢˜"
git push origin main
```

### 3. åœ¨Render Dashboardæ£€æŸ¥

1. è¿›å…¥ https://dashboard.render.com
2. æ‰¾åˆ°æ‚¨çš„ `rembg-api` æœåŠ¡
3. æŸ¥çœ‹ **Logs** é¡µé¢ï¼Œå¯»æ‰¾é”™è¯¯ä¿¡æ¯
4. ç¡®è®¤ **Settings** ä¸­çš„é…ç½®ï¼š
   - Build Command: (è‡ªåŠ¨ä»Dockerfile)
   - Start Command: `uvicorn api_server:app --host 0.0.0.0 --port $PORT --workers 1`
   - Health Check Path: `/health`

### 4. å¸¸è§Renderéƒ¨ç½²é—®é¢˜

#### é—®é¢˜A: ç«¯å£ç»‘å®šé”™è¯¯
**ç—‡çŠ¶**: "No open ports detected"
**è§£å†³**: ç¡®ä¿ä½¿ç”¨ `--host 0.0.0.0 --port $PORT`

#### é—®é¢˜B: å¥åº·æ£€æŸ¥å¤±è´¥
**ç—‡çŠ¶**: éƒ¨ç½²æ— é™å¾ªç¯
**è§£å†³**: ç¡®è®¤ `/health` ç«¯ç‚¹å¯è®¿é—®

#### é—®é¢˜C: å¯åŠ¨å‘½ä»¤é”™è¯¯
**ç—‡çŠ¶**: å®¹å™¨å¯åŠ¨åç«‹å³é€€å‡º
**è§£å†³**: æ£€æŸ¥uvicornå‘½ä»¤è¯­æ³•

### 5. éªŒè¯ä¿®å¤

éƒ¨ç½²å®Œæˆåï¼Œè¿è¡Œæµ‹è¯•ï¼š

```bash
python test_api_status.py
```

æœŸæœ›ç»“æœï¼š
- âœ… `/health` è¿”å› 200 çŠ¶æ€ç 
- âœ… `/` è¿”å› APIä¿¡æ¯
- âœ… `/docs` å¯è®¿é—®

### 6. å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

1. **æ£€æŸ¥RenderæœåŠ¡æ—¥å¿—**:
   - åœ¨Dashboardä¸­æŸ¥çœ‹å®æ—¶æ—¥å¿—
   - å¯»æ‰¾å¯åŠ¨é”™è¯¯æˆ–ç«¯å£ç»‘å®šé—®é¢˜

2. **æ‰‹åŠ¨é‡æ–°éƒ¨ç½²**:
   - åœ¨Render Dashboardä¸­ç‚¹å‡» "Manual Deploy"
   - é€‰æ‹©æœ€æ–°çš„commit

3. **éªŒè¯ç¯å¢ƒå˜é‡**:
   - ç¡®è®¤ `PORT` å’Œ `API_KEY` å·²è®¾ç½®

4. **è”ç³»Renderæ”¯æŒ**:
   - å¦‚æœæ‰€æœ‰é…ç½®éƒ½æ­£ç¡®ä½†ä»ç„¶å¤±è´¥
   - æä¾›æœåŠ¡åç§°å’Œè¯¦ç»†é”™è¯¯æ—¥å¿—

## æµ‹è¯•APIåŠŸèƒ½

ä¿®å¤åï¼Œæ‚¨å¯ä»¥è¿™æ ·æµ‹è¯•APIï¼š

```bash
# å¥åº·æ£€æŸ¥
curl https://rembg-12mt.onrender.com/health

# è·å–APIä¿¡æ¯
curl https://rembg-12mt.onrender.com/

# æµ‹è¯•èƒŒæ™¯ç§»é™¤ (éœ€è¦API Key)
curl -H "X-API-Key: your-api-key" \
     -F "file=@your-image.jpg" \
     https://rembg-12mt.onrender.com/remove-bg \
     --output result.png
```

## é¢„é˜²æªæ–½

1. **æœ¬åœ°æµ‹è¯•**: ä½¿ç”¨ `python test_local_api.py` éªŒè¯æ›´æ”¹
2. **ç›‘æ§**: è®¾ç½®Renderé€šçŸ¥ä»¥å¿«é€Ÿå‘ç°é—®é¢˜
3. **å¤‡ä»½**: ä¿æŒå·¥ä½œé…ç½®çš„å¤‡ä»½

---

ğŸ’¡ **æç¤º**: å¦‚æœæ‚¨ç»å¸¸é‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œè€ƒè™‘ä½¿ç”¨Renderçš„ä»˜è´¹è®¡åˆ’ä»¥è·å¾—æ›´ç¨³å®šçš„æœåŠ¡å’Œæ›´å¥½çš„æ”¯æŒã€‚ 